<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agregar Producto</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Agregar Producto</h1>
        </div>
        <div class="agregar-producto-container">
            <label for="nombreProducto">Nombre del Producto:</label>
            <input type="text" id="nombreProducto" placeholder="Nombre del Producto">
            <label for="precioProducto">Precio del Producto (Bs):</label>
            <input type="number" id="precioProducto" placeholder="Precio del Producto">
            <button onclick="agregarProducto()">Agregar Producto</button>

            <!-- Tabla para mostrar los productos -->
            <table id="tablaProductos">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Nombre</th>
                        <th>Precio (Bs)</th>
                        <th>Acciones</th> <!-- Columna para botón de eliminar -->
                    </tr>
                </thead>
                <tbody>
                    <!-- Aquí se llenarán los productos -->
                </tbody>
            </table>

            <div class="botones-container">
                <button onclick="location.href='index.html';">Volver</button>
            </div>
        </div>
    </div>

    <script>
        let productoIndex = 5;

        // Función para cargar productos personalizados desde localStorage y mostrar en la tabla
        function cargarProductosPersonalizados() {
            const productosPersonalizados = JSON.parse(localStorage.getItem('productosPersonalizados')) || [];
            const tablaProductos = document.getElementById('tablaProductos').getElementsByTagName('tbody')[0];
            tablaProductos.innerHTML = ''; // Limpiar tabla

            productosPersonalizados.forEach((producto, index) => {
                const row = tablaProductos.insertRow();
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${producto.nombre}</td>
                    <td>${producto.precio}</td>
                    <td><button onclick="eliminarProducto(${index})">Eliminar</button></td>
                `;
            });
        }

        // Función para guardar productos personalizados en localStorage
        function guardarProductosPersonalizados(productos) {
            localStorage.setItem('productosPersonalizados', JSON.stringify(productos));
        }

        // Función para agregar producto personalizado
        function agregarProducto() {
            const nombre = document.getElementById('nombreProducto').value.trim();
            const precio = parseFloat(document.getElementById('precioProducto').value);

            if (nombre === '' || isNaN(precio) || precio <= 0) {
                alert('Por favor, ingresa un nombre y un precio válido para el producto.');
                return;
            }

            const productosPersonalizados = JSON.parse(localStorage.getItem('productosPersonalizados')) || [];
            productoIndex++;
            productosPersonalizados.push({
                nombre: nombre,
                precio: precio,
                index: productoIndex
            });
            localStorage.setItem('productosPersonalizados', JSON.stringify(productosPersonalizados));

            alert('Producto agregado correctamente.');

            // Limpiar campos y actualizar tabla
            document.getElementById('nombreProducto').value = '';
            document.getElementById('precioProducto').value = '';
            cargarProductosPersonalizados();

            // Agregar el producto en la interfaz de index.html (si está abierto)
            if (window.opener) {
                window.opener.agregarProductoDom(nombre, precio, productoIndex);
            }
        }

        // Función para eliminar un producto personalizado por su índice
        function eliminarProducto(index) {
            if (confirm('¿Estás seguro de que quieres eliminar este producto?')) {
                let productosPersonalizados = JSON.parse(localStorage.getItem('productosPersonalizados')) || [];
                productosPersonalizados = productosPersonalizados.filter((producto, i) => i !== index);
                localStorage.setItem('productosPersonalizados', JSON.stringify(productosPersonalizados));
                cargarProductosPersonalizados(); // Actualizar la tabla después de eliminar
                alert('Producto eliminado correctamente.');
            }
        }

        // Cargar productos personalizados al cargar la página
        cargarProductosPersonalizados();
    </script>
</body>
</html>
